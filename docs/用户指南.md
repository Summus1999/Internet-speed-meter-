# 用户指南

## 安装

### 系统要求

- **操作系统**: Windows 10 或更新版本
- **处理器**: 任何现代处理器（Intel/AMD）
- **内存**: 最少 100 MB
- **磁盘空间**: 二进制文件占用 20 MB
- **网络**: 进行测试需要互联网连接

### 安装步骤

#### 方式 1: 下载预编译二进制文件（推荐）

1. 从 GitHub 下载最新版本
2. 将 ZIP 文件解压到所需位置
3. 可选：将目录添加到 PATH

#### 方式 2: 从源代码构建

1. 从 https://rustup.rs/ 安装 Rust
2. 克隆或下载项目
3. 导航到项目目录：
   ```bash
   cd Internet-speed-meter-
   ```
4. 构建项目：
   ```bash
   cargo build --release
   ```
5. 二进制文件位置: `target/release/internet-speed-meter.exe`

---

## 快速开始

### 基本命令

#### 1. 检查网络速度

```bash
.\internet-speed-meter.exe speed
```

**输出包含:**
- 下载速度（Mbps）
- 上传速度（Mbps）
- Ping 延迟（毫秒）
- 测试耗时

**输出示例:**
```
🚀 开始速度测试...
🔄 初始化速度测试...
✓ Ping: 25.00ms
✓ 下载: 85.50 Mbps
✓ 上传: 42.30 Mbps

📊 速度测试结果：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📥 下载速度: 85.50 Mbps
📤 上传速度: 42.30 Mbps
🔗 Ping: 25.00 ms
⏱️  执行时间: 2.15 s
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⏱️  测试在 2.15s 的时间内完成
```

#### 2. 诊断网络问题

```bash
.\internet-speed-meter.exe diagnose
```

**分析包含:**
- 网络连通性状态
- DNS 解析状态
- 可用的 DNS 服务器
- 网络延迟
- 数据包丢失百分比
- 检测到的问题
- 可操作的建议

#### 3. 运行完整分析

```bash
.\internet-speed-meter.exe all
```

结合速度测试和诊断的全面分析。

---

## 高级用法

### 指定自定义测试服务器

```bash
.\internet-speed-meter.exe speed --server http://speedtest.example.com/testfile
```

**常见测试服务器:**
- http://speedtest.ftp.otenet.gr/files/test10Mb.db
- http://files.staticcdn.com/test1gb.zip
- 你自己的测试文件 URL

### 诊断特定主机

测试到特定服务器的连通性：

```bash
# 测试 Google DNS
.\internet-speed-meter.exe diagnose --host 8.8.8.8

# 测试 Cloudflare DNS
.\internet-speed-meter.exe diagnose --host 1.1.1.1

# 测试阿里 DNS
.\internet-speed-meter.exe diagnose --host 223.5.5.5
```

---

## 理解结果

### 速度测试指标

| 指标 | 单位 | 含义 | 良好范围 |
|--------|------|------|---------|
| **下载速度** | Mbps | 下载文件的速度 | > 25 Mbps |
| **上传速度** | Mbps | 上传文件的速度 | > 10 Mbps |
| **Ping** | ms | 响应延迟（越低越好） | < 50 ms |
| **耗时** | s | 总测试时间 | 2-5 s |

**速度评级:**
- **优秀**: 下载 > 100 Mbps
- **很好**: 下载 50-100 Mbps
- **良好**: 下载 25-50 Mbps
- **一般**: 下载 10-25 Mbps
- **较差**: 下载 < 10 Mbps

**Ping 评级:**
- **优秀**: < 10 ms
- **很好**: 10-30 ms
- **良好**: 30-50 ms
- **一般**: 50-100 ms
- **较差**: > 100 ms

### 诊断结果

#### 连通性状态
- **✓ 正常**: 网络已连接且正常运行
- **✗ 失败**: 没有网络连接

#### DNS 解析
- **✓ 正常**: DNS 服务器正常响应
- **✗ 失败**: 无法解析域名

#### DNS 服务器
显示用于域名解析的配置的 DNS 服务器。

#### 延迟
到达目标主机的往返时间。
- **正常**: 20-50 ms（同一区域）
- **可接受**: 50-100 ms
- **较高**: > 100 ms（可能存在问题）

#### 数据包丢失
未能到达目的地的数据包百分比。
- **0%**: 无数据包丢失（完美）
- **< 1%**: 正常、可接受
- **> 1%**: 存在网络问题

### 常见问题和解决方案

#### 问题: 下载速度低

**可能原因:**
- 网络流量繁重
- 距离服务器远
- ISP 限速
- WiFi 信号弱

**解决方案:**
1. 在不同时间运行测试
2. 使用有线以太网连接
3. 检查 WiFi 信号强度
4. 重启调制解调器/路由器
5. 联系 ISP 获取支持

#### 问题: Ping 高/延迟高

**可能原因:**
- 网络拥堵
- WiFi 干扰
- 路由器问题
- ISP 问题

**解决方案:**
1. 减少后台下载
2. 靠近 WiFi 路由器
3. 切换到 5GHz WiFi 频段
4. 重启路由器
5. 检查干扰源

#### 问题: DNS 解析失败

**可能原因:**
- DNS 服务器宕机
- 防火墙阻止 DNS
- DNS 配置不正确
- 网络隔离

**解决方案:**
1. 重启路由器
2. 更换为公共 DNS（8.8.8.8、1.1.1.1）
3. 检查 Windows DNS 设置
4. 临时禁用防火墙（仅测试）
5. 联系 ISP

#### 问题: 检测到数据包丢失

**可能原因:**
- WiFi 信号弱
- 网络硬件故障
- 干扰
- ISP 网络问题

**解决方案:**
1. 使用有线连接
2. 检查 WiFi 信号
3. 减少连接的设备数量
4. 更新网络驱动程序
5. 检查电缆连接

---

## 技巧和窍门

### 最佳测试条件

1. **使用以太网** - 有线连接最准确
2. **关闭其他应用** - 最小化后台网络使用
3. **多次测试** - 运行多次取平均值
4. **一致的时间** - 在固定时间测试以追踪趋势
5. **清除缓存** - 浏览器缓存不会影响此工具

### 网络问题故障排除

**逐步诊断:**

```bash
# 1. 检查基本连通性
.\internet-speed-meter.exe diagnose

# 2. 如果 DNS 失败，尝试不同的 DNS
.\internet-speed-meter.exe diagnose --host 1.1.1.1

# 3. 运行速度测试检查带宽
.\internet-speed-meter.exe speed

# 4. 运行完整分析
.\internet-speed-meter.exe all
```

### 性能优化

**提高网络速度:**

1. **路由器级别:**
   - 重启路由器
   - 更新固件
   - 优化 WiFi 频道（使用 WiFi 分析工具）
   - 减少干扰

2. **设备级别:**
   - 重启计算机
   - 更新网络驱动程序
   - 临时禁用 VPN
   - 检查恶意软件

3. **网络级别:**
   - 使用以太网电缆
   - 靠近路由器
   - 减少连接的设备
   - 联系 ISP 获取支持

---

## 常见问题

### Q: 为什么我的结果与其他测速工具不同?

**A:** 不同的测试服务器和方法会产生不同的结果。此工具使用模拟进行原型设计。要获得实际结果，请连接到真实测试服务器。

### Q: 我的速度是否足够好?

**A:** 这取决于你的计划和需求:
- 流媒体: > 25 Mbps
- 视频通话: > 5 Mbps
- 游戏: > 10 Mbps（低延迟很重要）
- 基本浏览: > 5 Mbps

### Q: "数据包丢失"是什么意思?

**A:** 一些数据包未能到达目的地。0% 是理想的。>1% 表示网络存在问题。

### Q: 我可以测试特定服务器吗?

**A:** 可以，使用 `--server` 选项:
```bash
.\internet-speed-meter.exe speed --server http://your-server.com/file
```

### Q: 为什么诊断需要更长时间?

**A:** 它执行多个检查（连通性、DNS、延迟、数据包丢失）依次进行，需要时间。

### Q: 我能否计划自动测试?

**A:** 还不支持，但这是未来版本的计划。你可以创建批处理脚本:

```batch
@echo off
REM test.bat - 运行每日速度测试
.\internet-speed-meter.exe all >> speedtest_log.txt
```

然后用 Windows 任务计划程序调度。

### Q: 如果出现错误怎么办?

**A:** 常见错误:

| 错误 | 解决方案 |
|------|---------|
| "找不到命令" | 检查二进制位置，添加到 PATH |
| "网络无法到达" | 检查互联网连接 |
| "连接失败" | 检查防火墙设置 |
| "权限被拒" | 以管理员权限运行 |

### Q: 我如何卸载?

**A:** 只需删除二进制文件:
```bash
del internet-speed-meter.exe
```

---

## 系统设置

### 防火墙配置

如果被 Windows Defender 防火墙阻止:

1. 打开 Windows Defender 防火墙
2. 点击"允许应用通过防火墙"
3. 将 `internet-speed-meter.exe` 添加到允许的应用
4. 同时选择私有网络和公用网络
5. 点击确定

### 管理员权限

某些诊断可能需要管理员权限:

```batch
# 以管理员身份运行
@echo off
cd /d %~dp0
.\internet-speed-meter.exe diagnose
pause
```

### 环境变量

高级用法:

```batch
set RUST_LOG=debug
.\internet-speed-meter.exe speed
```

---

## 性能说明

- **首次运行**: 可能需要更长时间（构建缓存）
- **后续运行**: 快得多
- **网络繁重**: 测试期间禁用其他下载
- **CPU 使用**: 最少，主要受 I/O 限制

---

## 获取帮助

### 文档
- **API 指南**: 查看 `docs/API.md` 获取开发者信息
- **开发指南**: 查看 `docs/DEVELOPMENT.md` 获取贡献信息

### 报告问题
1. 准确记录错误消息
2. 包含系统信息
3. 描述重现步骤
4. 检查重启后是否仍然存在
5. 在 GitHub 上提交 issue

### 社区支持
- 检查现有 issue
- 搜索文档
- 提交讨论
- 联系仓库维护者

---

## 版本信息

- **当前版本**: 0.1.0
- **最后更新**: 2025 年 11 月 16 日
- **平台**: Windows 10+

有关最新版本和更新，请访问项目仓库。

---

祝你使用愉快！🚀
